<!doctype html>
<html>
<head><meta charset="utf-8"/><title>Set password</title></head>
<body>
  <h3>Set your password</h3>
  <p id="info"></p>
  <label>New password <input id="pw" type="password"></label>
  <button id="btnSet">Set password</button>
  <div id="msg"></div>
<script>
const base = 'http://localhost:8080';
const params = new URLSearchParams(location.search);
const token = params.get('token');
document.getElementById('info').innerText = token ? 'Token present' : 'No token in URL';
document.getElementById('btnSet').addEventListener('click', async () => {
  const pw = document.getElementById('pw').value;
  if (!token || !pw) return document.getElementById('msg').innerText = 'Token + password required';
  const r = await fetch(base + '/users/set-password', {
    method:'POST', headers:{ 'Content-Type':'application/json' }, body: JSON.stringify({ token, password: pw })
  });
  const j = await r.json();
  document.getElementById('msg').innerText = j.ok ? 'Password set. You can login now.' : JSON.stringify(j);
});
</script>
</body>
</html>
